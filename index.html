<?php

// Thay thế YOUR_ORIGINAL_URL bằng URL thực tế mà bạn muốn che giấu
$originalUrl = "https://beautifier.io/";

// Thay thế YOUR_CLOAKED_URL bằng URL thực tế mà bạn muốn người dùng được chuyển hướng đến
$cloakedUrl = "https://www.theverge.com/";

// Thiết lập địa chỉ IP và mã quốc gia của người dùng
$ipAddress = $_SERVER["REMOTE_ADDR"];
$countryCode = file_get_contents("https://ipapi.co/{$ipAddress}/country/");

// Kiểm tra xem người dùng có truy cập từ thiết bị di động không
$isMobile = preg_match("/(android|blackberry|iphone|ipad|ipod|iemobile|opera mobile|palmos|webos|googlebot-mobile)/i", $_SERVER["HTTP_USER_AGENT"]);

// Chỉ cho phép truy cập đến URL được che giấu nếu người dùng đến từ Hoa Kỳ và sử dụng user agent di động
if ($countryCode == "US" && $isMobile) {
  // Chuyển hướng người dùng đến URL được che giấu
  header("Location: $cloakedUrl");

  // Thiết lập cookie để nhớ URL ban đầu
  setcookie("originalUrl", $originalUrl, time() + 3600, "/");
} else {
  // Hiển thị thông báo lỗi
  echo "Truy cập bị từ chối.";
}

?>

<!-- Hiển thị một trang web cho thấy URL gốc trong thanh địa chỉ -->
<html>
  <head>
    <title>Đang tải...</title>
    <meta http-equiv="refresh" content="0;url=<?php echo $cloakedUrl; ?>">
  </head>
  <body>
    <p>Vui lòng đợi trong khi chúng tôi chuyển hướng bạn đến trang đích...</p>
  </body>
</html>
